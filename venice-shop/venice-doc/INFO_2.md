###简介
本章节只介绍商城模块的系统设计，基础模块请移步
###数据库
![数据库设计](
http://image.enfunly.com/images/shop.jpg)
###商品设计
- 商品分类表 sh_goods_category
- 商品表 sh_goods
- 规格表 sh_specification
- 商品规格表 sh_goods_specification
- 产品表 sh_product 
- 品牌表 sh_brand
- 主题表 sh_topic
- 主题关联商品表 sh_topic_goods 
- 广告表 sh_advert 
- 商品关键字 sh_keywords (规划中)
- 优惠券 sh_coupon
####重点提醒
商品 --> 规格表  --> 商品规格表  -->产品表
商品是否启用规格开关
1. 不启用规格
    产品表中插入默认的商品配置中的信息
    - 如 新增一个商品 市场价 99  零售价 89 商品图片 a.jpg 库存量 200  则会在产品表中也新增一笔相同的数据。
2. 启用规格
- 如新增一件苍老师作品
- 规格名称有2种各有2种规格值
   - 规格名称“时长”，规格值“1分钟” 
   - 规格名称“时长”，规格值“120分钟” 
   - 规格名称“清晰度”，规格值“270P” 
   - 规格名称“清晰度”，规格值“蓝光8M”
- 存在4种产品
  - 产品 “1分钟，270P” ，名称 “非会员试看”，数量100，价格 100 ，图片 1.jpg
  - 产品 “1分钟，蓝光8M” ，名称 “会员试看”，数量100，价格 100，图片 2.jpg
  - 产品 “120分钟，270P” ，名称 “非会员全片”，数量100，价格 100 ，图片 3.jpg
  - 产品 “120分钟，蓝光8M” ，名称 “会员全片”，数量100，价格 100，图片 4.jpg
####基于以上情况，数据存储为
1. 规格表
新增2条数据  时长  清晰度
2. 规格商品表
新增4笔数据 1分钟 120分钟 270P 蓝光8M
3.产品表
新增4笔数据  非会员试看  会员试看 非会员全片 会员全片
spec_key值 :5_7  每个规格商品的id 拼接 用_分开
###订单设计
- 购物车 sh_cart
- 订单主表 sh_order
- 订单商品表 sh_order_goods
- 订单日志表 sh_order_log
- 订单支付信息表 sh_order_pay
- 退款信息表 sh_order_return 
- 退款信息日志表 sh_order_return_log
####重点提醒
1. 订单编码,规则(年月日时分秒+用户ID后4位)=16位   如用户id4位补0,如0899
2. 订单状态由3个字段组成 orderStatus payStatus shippingStatus 在工具类ShOrderUtils中对3个字段整合为 
1--（待付款）已提交待支付 2--（已取消）已取消 3--（待发货）已提交已支付待发货
 4--（已退款）已退款  5--（部分发货）已提交已支付部分发货 6--（待收货）已提交已支付全部发货  7--(已退货)已提交已支付已退货 8--（已完成）已完成
###用户中心设计
- 用户表 sh_user
- 用户优惠券表 sh_coupon_user
- 用户足迹 sh_footprint
- 用户评价表 sh_comment
- 用户搜索历史表 sh_search_history
- 用户收货地址表 sh_address 
- 用户收藏表 sh_collect



